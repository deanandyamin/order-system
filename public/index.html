<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ç·šä¸Šé»é¤</title>
  <style>
    :root {
      --brand-color: #fd7e14;
      --brand-color-dark: #e36e10;
      --text-color: #333;
      --bg-color: #f4f4f4;
      --cart-bg: #fff9db;
      --cart-bg-confirm: #ffd6d6;
      --white: #fff;
      --border-color: #ddd;
      --transition-fast: 0.3s;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
    }

    .top-bar {
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      width: 200px;
      padding: 15px;
      background-color: var(--white);
      box-shadow: 2px 0 4px rgba(0,0,0,0.1);
      z-index: 100;
      display: flex;
      flex-direction: column;
    }
    .category-group {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .category-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background-color: #ccc;
      color: var(--white);
      font-size: 16px;
      cursor: pointer;
      transition: background-color var(--transition-fast);
    }
    .category-btn:hover {
      filter: brightness(90%);
    }
    .category-btn.selected {
      background-color: var(--brand-color);
    }

    .main-container {
      margin-left: 220px;
      margin-right: 320px;
      padding: 20px;
      display: flex;
      justify-content: flex-start;
      position: relative;
    }
    .product-area {
      background-color: var(--white);
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      text-align: center;
      width: 100%;
    }
    .product-area h2 {
      margin-top: 0;
      font-size: 24px;
      color: var(--brand-color);
    }

    .menu-container {
      display: grid;
      grid-template-columns: repeat(5, minmax(140px, 1fr));
      gap: 20px;
      justify-items: center;
      margin: 20px 0;
      min-height: 400px;
    }
    .menu-item {
      background: var(--white);
      width: 100%;
      min-height: 220px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 10px;
      text-align: center;
      cursor: pointer;
      transition: box-shadow var(--transition-fast), background-color var(--transition-fast);
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      align-items: center;
    }
    .menu-item:hover {
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .menu-item img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .menu-item p {
      margin: 5px 0 0;
      font-size: 14px;
      color: var(--text-color);
      font-weight: bold;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }
    .menu-item.selected {
      background-color: var(--brand-color);
      color: var(--white);
    }
    .menu-item.selected p {
      color: var(--white);
    }
    .quantity-controls {
      display: flex;
      justify-content: center;
      gap: 5px;
      margin-top: 5px;
    }
    .quantity-controls button {
      width: 25px;
      height: 25px;
      border: none;
      background-color: var(--brand-color-dark);
      color: var(--white);
      border-radius: 3px;
      cursor: pointer;
    }
    .quantity-controls span {
      font-size: 14px;
      color: var(--text-color);
    }
    .menu-item.selected .quantity-controls span {
      color: var(--white);
    }

    .actions {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    .actions button {
      padding: 10px 25px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
      color: var(--white);
      background-color: var(--brand-color);
      cursor: pointer;
    }
    .actions button:hover {
      background-color: var(--brand-color-dark);
    }
    .page-info {
      margin-top: 10px;
      font-weight: bold;
      color: var(--text-color);
    }

    .order-mode-container {
      margin-top: 25px;
    }
    .order-mode-buttons {
      display: flex;
      justify-content: center;
      gap: 25px;
      margin-bottom: 20px;
    }
    .mode-btn {
      padding: 12px 20px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
      color: var(--white);
      background-color: var(--brand-color);
      cursor: pointer;
      transition: background-color var(--transition-fast);
    }
    .mode-btn:hover {
      background-color: var(--brand-color-dark);
    }

    .table-select-container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin-bottom: 15px;
    }
    .table-btn {
      width: 60px;
      padding: 8px;
      background-color: var(--brand-color);
      color: var(--white);
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color var(--transition-fast);
    }
    .table-btn:hover {
      background-color: var(--brand-color-dark);
    }

    .takeout-number {
      font-size: 16px;
      margin-bottom: 15px;
      color: var(--text-color);
      font-weight: bold;
    }

    #submitOrderBtn {
      padding: 12px 25px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
      color: var(--white);
      background-color: var(--brand-color);
      cursor: pointer;
    }
    #submitOrderBtn:hover {
      background-color: var(--brand-color-dark);
    }

    #cart {
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      width: 300px;
      background-color: var(--cart-bg);
      border-left: 1px solid #e6d57a;
      padding: 15px;
      box-shadow: -2px 0 8px rgba(0,0,0,0.1);
      overflow-y: auto;
    }
    #cart h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    #cartList {
      list-style: none;
      padding: 0;
      margin: 0;
      line-height: 1.5;
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding-bottom: 10px;
    }
    #cartList li {
      padding: 10px;
      background: rgba(255,255,255,0.5);
      border-radius: 4px;
      word-wrap: break-word;
    }
    .cart-confirmation {
      background-color: var(--cart-bg-confirm) !important;
      border: 1px solid #ffaaaa !important;
    }
    .total-price {
      color: red;
      font-size: 1.2em;
      font-weight: bold;
      margin-top: 10px;
      display: inline-block;
    }

    .modal-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .modal-content {
      background: var(--white);
      padding: 20px 30px;
      border-radius: 8px;
      text-align: center;
    }
    .modal-content p {
      margin: 0 0 20px 0;
      font-size: 18px;
    }

    .notification {
      position: fixed;
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 36px;
      z-index: 1000;
      opacity: 1;
      transition: opacity var(--transition-fast) ease-in-out;
    }

 /* ç°¡æ˜“ç¯„ä¾‹ï¼šå…¨è¢å¹•è¦†è“‹é¡¯ç¤ºå¤–å¸¶ç·¨è™Ÿ */
    .takeout-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 9999;
      font-size: 40px;
      text-align: center;
      padding: 20px;
    }
    .takeout-overlay h1 {
      font-size: 80px; /* å¤§å­—é¡¯ç¤ºç·¨è™Ÿ */
      margin: 0;
      padding: 0;
    }
    .takeout-overlay p {
      margin-top: 20px;
      font-size: 24px;
      line-height: 1.5;
    }
    .logo-container {
      margin-top: 20px;
      text-align: center;
    }
    .logo-container img {
      width: 150px;
      height: 150px;
    }
    .takeout-notice {
      font-size: 16px;
      margin-bottom: 10px;
    }

    .confirm-order-btn,
    .cancel-order-btn {
      padding: 10px 25px;
      border-radius: 5px;
      border: none;
      font-size: 16px;
      color: var(--white);
      cursor: pointer;
      display: block;
      width: 100%;
      margin: 10px 0;
      transition: background-color var(--transition-fast);
    }

    .confirm-order-btn {
      background-color: #8B9E8B;
    }

    .confirm-order-btn:hover {
      background-color: #7A8C7A;
    }
    .cancel-order-btn {
      background-color: #dc3545;
    }

    .cancel-order-btn:hover {
      background-color: #c82333;
    }
  </style>
</head>
<body>
  <div class="top-bar">
    <div class="category-group">
      <div class="logo-container">
        <img src="images/123.jpg" alt="å—¨å­éºµ Logo">
      </div>
      <button class="category-btn" id="btn-a" onclick="selectCategory('éºµé£Ÿ')">éºµé£Ÿ</button>
      <button class="category-btn" id="btn-b" onclick="selectCategory('æ¹¯é¡')">æ¹¯é¡</button>
      <button class="category-btn" id="btn-c" onclick="selectCategory('ç‰¹è£½æ»·èœ')">ç‰¹è£½æ»·èœ</button>
      <button class="category-btn" id="btn-d" onclick="selectCategory('é¬†é¤…')">é¬†é¤…</button>
      <button class="category-btn" id="btn-e" onclick="selectCategory('è›‹é¤…')">è›‹é¤…</button>
      <button class="category-btn" id="btn-f" onclick="selectCategory('é£²æ–™')">é£²æ–™</button>
    </div>
  </div>

  <div class="main-container">
    <div class="product-area">
      <h2 id="categoryTitle">é¸æ“‡æ‚¨çš„é¤é»</h2>
      <div class="menu-container" id="menu"></div>

      <div class="actions">
        <button onclick="prevPage()">ä¸Šä¸€é </button>
        <button onclick="nextPage()">ä¸‹ä¸€é </button>
      </div>
      <div class="page-info">
        ç¬¬ <span id="currentPageNumber">1</span> é 
      </div>

      <div class="order-mode-container" id="orderModeContainer">
        <div class="order-mode-buttons">
          <button class="mode-btn" onclick="selectDineIn()">å…§ç”¨</button>
          <button class="mode-btn" onclick="selectTakeOut()">å¤–å¸¶</button>
        </div>

        <div class="table-select-container" id="tableSelectContainer" style="display: none;"></div>
        <div class="takeout-number" id="takeoutNumberDisplay" style="display: none;"></div>
        <button class="mode-btn" id="submitOrderBtn" style="display: none;" onclick="showConfirmation()">é€å‡ºè¨‚å–®</button>
      </div>
    </div>
  </div>

  <div id="cart">
    <h3>ğŸ›’ æ‚¨çš„è³¼ç‰©è»Šæ¸…å–®ï¼š</h3>
    <ul id="cartList"></ul>
  </div>

  <div id="customModal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <p id="modalMessage">é€™è£¡æœƒé¡¯ç¤ºæç¤ºè¨Šæ¯</p>
      <button onclick="closeModal()">ç¢ºèª</button>
    </div>
  </div>

  <script>
    const menuData = {
      "éºµé£Ÿ": [
        { name: "ç´…ç‡’ç‰›è‚‰éºµ", price: 230, img: "images/food1.jpg" },
        { name: "æ¸…ç‡‰ç‰›è‚‰éºµ", price: 230, img: "images/food2.jpg" },
        { name: "éº»è¾£ç‰›è‚‰éºµ", price: 235, img: "images/food3.jpg" },
        { name: "ç‰›ç­‹éºµ",     price: 235, img: "images/food4.jpg" },
        { name: "ç´…ç‡’ç‰›è…©éºµ", price: 230, img: "images/food5.jpg" },
        { name: "ç‰›å°¾éºµ",     price: 230, img: "images/food6.jpg" },
        { name: "ç‰›ä¸‰å¯¶éºµ",   price: 240, img: "images/food7.jpg" },
        { name: "ç‰›å°æ’éºµ",   price: 300, img: "images/food8.jpg" },
        { name: "ç‰›æ’éºµ",     price: 300, img: "images/food9.jpg" },
        { name: "é™½æ˜¥éºµ",     price: 40,  img: "images/food10.jpg" },
      ],
      "æ¹¯é¡": [
        { name: "ç´…ç‡’ç‰›è‚‰æ¹¯", price: 200, img: "images/food11.jpg" },
        { name: "æ¸…ç‡‰ç‰›è‚‰æ¹¯", price: 200, img: "images/food12.jpg" },
        { name: "éº»è¾£ç‰›è‚‰æ¹¯", price: 205, img: "images/food13.jpg" },
        { name: "ç‰›ç­‹æ¹¯",     price: 205, img: "images/food14.jpg" },
        { name: "ç´…ç‡’ç‰›è…©æ¹¯", price: 200, img: "images/food15.jpg" },
        { name: "é¤›é£©æ¹¯",     price: 50,  img: "images/food16.jpg" },
        { name: "ç‰›è‚šæ¹¯",     price: 200, img: "images/food17.jpg" },
        { name: "ç‰›é›œæ¹¯",     price: 200, img: "images/food18.jpg" },
        { name: "ç‰›å°¾æ¹¯",     price: 200, img: "images/food19.jpg" },
      ],
      "ç‰¹è£½æ»·èœ": [
        { name: "é­¯è›‹",       price: 10,  img: "images/food20.jpg" },
        { name: "æ»·å‘³æ‹¼ç›¤",   price: 150, img: "images/food21.jpg" },
        { name: "æ»·ç‰›è…±",     price: 80,  img: "images/food22.jpg" },
        { name: "æ»·ç‰›è‚š",     price: 80,  img: "images/food23.jpg" },
        { name: "æ»·ç‰›é›œ",     price: 80,  img: "images/food24.jpg" },
        { name: "æ»·ç‰›è…©",     price: 80,  img: "images/food25.jpg" },
        { name: "ç‰›ç­‹",       price: 100, img: "images/food26.jpg" },
        { name: "æµ·å¸¶",       price: 20,  img: "images/food27.jpg" },
        { name: "è±†å¹²",       price: 20,  img: "images/food28.jpg" }
      ],
  "é¬†é¤…": [
    { "name": "åŸå‘³é¬†é¤…", "price": 120, "img": "/images/food29.jpg" },
    { "name": "å·§å…‹åŠ›é¬†é¤…", "price": 130, "img": "/images/food30.jpg" },
    { "name": "èœ‚èœœé¬†é¤…", "price": 130, "img": "/images/food31.jpg" },
    { "name": "è—è“é¬†é¤…", "price": 140, "img": "/images/food32.jpg" },
    { "name": "é¦™è•‰é¬†é¤…", "price": 140, "img": "/images/food33.jpg" },
    { "name": "æŠ¹èŒ¶é¬†é¤…", "price": 150, "img": "/images/food34.jpg" },
    { "name": "å¥¶æ²¹é¬†é¤…", "price": 120, "img": "/images/food35.jpg" }
  ],
  "è›‹é¤…": [
    { "name": "åŸå‘³è›‹é¤…", "price": 60, "img": "/images/food36.jpg" },
    { "name": "èµ·å¸è›‹é¤…", "price": 70, "img": "/images/food37.jpg" },
    { "name": "åŸ¹æ ¹è›‹é¤…", "price": 75, "img": "/images/food38.jpg" },
    { "name": "ç«è…¿è›‹é¤…", "price": 70, "img": "/images/food39.jpg" },
    { "name": "ç‰ç±³è›‹é¤…", "price": 65, "img": "/images/food40.jpg" },
    { "name": "è”¬èœè›‹é¤…", "price": 70, "img": "/images/food41.jpg" }
  ],
  "é£²æ–™": [
    { "name": "ç´…èŒ¶", "price": 30, "img": "/images/food42.jpg" },
    { "name": "å¥¶èŒ¶", "price": 40, "img": "/images/food43.jpg" },
    { "name": "ç¶ èŒ¶", "price": 30, "img": "/images/food44.jpg" },
    { "name": "ç¾å¼å’–å•¡", "price": 50, "img": "/images/food45.jpg" },
    { "name": "æ‹¿éµ", "price": 60, "img": "/images/food46.jpg" },
    { "name": "å¯å¯", "price": 55, "img": "/images/food47.jpg" }
  ]

    };

    let selectedCategory = "éºµé£Ÿ";
    let selectedItems = new Map();
    let currentPage = 0;
    const itemsPerPage = 10;

    let orderType = "";
    let selectedTableNumber = "";


    window.onload = () => {
      console.log("Window loaded, initializing...");
      updateCategoryButtons();
      renderMenu();
      updateCart();
      generateTableButtons();
    };

    function selectCategory(category) {
      selectedCategory = category;
      currentPage = 0;
      updateCategoryButtons();
      renderMenu();
    }

    function updateCategoryButtons() {
      document.getElementById("btn-a").classList.remove("selected");
      document.getElementById("btn-b").classList.remove("selected");
      document.getElementById("btn-c").classList.remove("selected");
      document.getElementById("btn-d").classList.remove("selected");
      document.getElementById("btn-e").classList.remove("selected");
      document.getElementById("btn-f").classList.remove("selected");

      if (selectedCategory === "éºµé£Ÿ") {
        document.getElementById("btn-a").classList.add("selected");
      } else if (selectedCategory === "æ¹¯é¡") {
        document.getElementById("btn-b").classList.add("selected");
      } else if (selectedCategory === "ç‰¹è£½æ»·èœ") {
        document.getElementById("btn-c").classList.add("selected");
      } else if (selectedCategory === "é¬†é¤…") {
        document.getElementById("btn-d").classList.add("selected");
      } else if (selectedCategory === "è›‹é¤…") {
        document.getElementById("btn-e").classList.add("selected");
      } else if (selectedCategory === "é£²æ–™") {
        document.getElementById("btn-f").classList.add("selected");
      }
      document.getElementById("categoryTitle").textContent = selectedCategory;
    }

    function getCurrentCategoryItems() {
      return menuData[selectedCategory] || [];
    }

    function renderMenu() {
      let menuContainer = document.getElementById("menu");
      menuContainer.innerHTML = "";

      let allItems = getCurrentCategoryItems();
      if (!allItems || allItems.length === 0) {
        menuContainer.innerHTML = "<p>ç›®å‰æ²’æœ‰å•†å“</p>";
        console.log("No items found for category:", selectedCategory);
        return;
      }

      let start = currentPage * itemsPerPage;
      let end = start + itemsPerPage;
      let pageItems = allItems.slice(start, end);

      console.log("Rendering items:", pageItems);

      document.getElementById("currentPageNumber").innerText = currentPage + 1;

      pageItems.forEach((item, index) => {
        try {
          let div = document.createElement("div");
          div.classList.add("menu-item");

          let selected = selectedItems.get(item.name);
          if (selected) {
            div.classList.add("selected");
          }

          // ç¢ºä¿ img å±¬æ€§å­˜åœ¨ï¼Œè‹¥ç„¡å‰‡ä½¿ç”¨é è¨­å€¼
          let imgSrc = item.img || "https://via.placeholder.com/100";
          let itemName = item.name || "æœªçŸ¥å•†å“";
          let itemPrice = item.price || 0;

          div.innerHTML = `
            <img src="${imgSrc}" alt="${itemName}" onerror="this.src='https://via.placeholder.com/100'">
            <p>${itemName} ($${itemPrice})</p>
            ${selected ? `
              <div class="quantity-controls">
                <button onclick="decreaseQuantity('${itemName}', event)">-</button>
                <span>${selected.quantity}</span>
                <button onclick="increaseQuantity('${itemName}', event)">+</button>
              </div>` : ""}
          `;
          if (!selected) div.onclick = () => toggleSelection(item);
          menuContainer.appendChild(div);
        } catch (error) {
          console.error(`Error rendering item at index ${index}:`, item, error);
        }
      });
    }

    function toggleSelection(item) {
      if (selectedItems.has(item.name)) {
        let current = selectedItems.get(item.name);
        current.quantity++;
      } else {
        selectedItems.set(item.name, { item, quantity: 1 });
      }
      renderMenu();
      updateCart();
    }

    function increaseQuantity(name, event) {
      event.stopPropagation();
      let current = selectedItems.get(name);
      current.quantity++;
      renderMenu();
      updateCart();
    }

    function decreaseQuantity(name, event) {
      event.stopPropagation();
      let current = selectedItems.get(name);
      if (current.quantity > 1) {
        current.quantity--;
      } else {
        selectedItems.delete(name);
      }
      renderMenu();
      updateCart();
    }

    function prevPage() {
      if (currentPage > 0) {
        currentPage--;
        renderMenu();
      } else {
        showNotification("é€™å·²æ˜¯ç¬¬ä¸€é ");
      }
    }

    function nextPage() {
      let allItems = getCurrentCategoryItems();
      let maxPages = Math.ceil(allItems.length / itemsPerPage) - 1;
      if (currentPage < maxPages) {
        currentPage++;
        renderMenu();
      } else {
        showNotification("é€™å·²æ˜¯æœ€å¾Œä¸€é ");
      }
    }

    function updateCart() {
      let cartList = document.getElementById("cartList");
      cartList.innerHTML = "";

      if (selectedItems.size === 0) {
        cartList.innerHTML = "<p style='color: #999;'>è³¼ç‰©è»Šæ˜¯ç©ºçš„</p>";
        return;
      }

      let totalPrice = 0;
      for (let [name, { item, quantity }] of selectedItems) {
        let li = document.createElement("li");
        li.textContent = `${name} ($${item.price}) x ${quantity}`;
        cartList.appendChild(li);
        totalPrice += item.price * quantity;
      }

      let totalLi = document.createElement("li");
      totalLi.innerHTML = `ç´¯è¨ˆç¸½é‡‘é¡ï¼š<span class="total-price">$${totalPrice}</span>`;
      cartList.appendChild(totalLi);
    }

    function selectDineIn() {
      orderType = "å…§ç”¨";
      document.querySelector(".order-mode-buttons").style.display = "none";

      selectedTableNumber = "";
      document.getElementById("tableSelectContainer").style.display = "flex";

      let tableMsg = document.createElement("div");
      tableMsg.textContent = "è«‹é»é¸ä½ çš„æ¡Œè™Ÿ";
      tableMsg.style.textAlign = "center";
      tableMsg.style.marginBottom = "10px";
      document.getElementById("tableSelectContainer").insertAdjacentElement("beforebegin", tableMsg);

      document.getElementById("takeoutNumberDisplay").style.display = "none";
      document.getElementById("submitOrderBtn").style.display = "none";
    }

    function selectTakeOut() {
  orderType = "å¤–å¸¶";
  document.querySelector(".order-mode-buttons").style.display = "none";
  
  selectedTableNumber = "";
  
  // ç§»é™¤å‰ç«¯å–é¤è™Ÿé‚è¼¯ï¼Œç›´æ¥éš±è—æ¡Œè™Ÿé¸æ“‡å€
  document.getElementById("tableSelectContainer").style.display = "none";
  // é¡¯ç¤ºé€å‡ºè¨‚å–®æŒ‰éˆ•
  document.getElementById("submitOrderBtn").style.display = "inline-block";
}

    function generateTableButtons() {
      let container = document.getElementById("tableSelectContainer");
      container.innerHTML = "";
      for (let i = 1; i <= 15; i++) {
        let btn = document.createElement("button");
        btn.classList.add("table-btn");
        btn.textContent = i;
        btn.onclick = () => {
          selectedTableNumber = i;
          container.style.display = "none";
          document.getElementById("submitOrderBtn").style.display = "inline-block";
        };
        container.appendChild(btn);
      }
    }

    function showConfirmation() {
      if (selectedItems.size === 0) {
        showModal("è«‹è‡³å°‘é¸æ“‡ä¸€é …èœå“ï¼");
        return;
      }
      if (!orderType) {
        showModal("è«‹å…ˆé¸æ“‡å…§ç”¨æˆ–å¤–å¸¶ï¼");
        return;
      }
      if (orderType === "å…§ç”¨" && !selectedTableNumber) {
        showModal("è«‹å…ˆé¸æ“‡æ¡Œè™Ÿï¼");
        return;
      }
    

      let cartDiv = document.getElementById("cart");
      cartDiv.classList.add("cart-confirmation");
      cartDiv.querySelector("h3").textContent = "è«‹æœ€å¾Œç¢ºèªä½ çš„é¤é»";

      document.getElementById("orderModeContainer").style.display = "none";

      showConfirmCancelButtons();
    }

    function showConfirmCancelButtons() {
        let buttonContainer = document.createElement("div");
        buttonContainer.style.display = "flex";
        buttonContainer.style.flexDirection = "column";
        buttonContainer.style.alignItems = "center";
        buttonContainer.style.marginTop = "10px";
    
        if (orderType === "å¤–å¸¶") {
            let notice = document.createElement("div");
            notice.className = "takeout-notice";
            notice.innerHTML = "âš ï¸ é»æ“Šç¢ºèªè¨‚å–®å‰è«‹å…ˆæ‹¿å‡ºæ‰‹æ©Ÿï¼Œæ‹ç…§ä¿å­˜æ‚¨çš„å–é¤è™Ÿç¢¼ï¼Œ";
            buttonContainer.appendChild(notice);
        }
    
        let confirmButton = document.createElement("button");
        confirmButton.textContent = "ç¢ºèªè¨‚å–®ä¸¦è‡³æ«ƒæª¯ä»˜æ¬¾";
        confirmButton.className = "confirm-order-btn";
        confirmButton.onclick = confirmOrder;
    
        let cancelButton = document.createElement("button");
        cancelButton.textContent = "å–æ¶ˆè¨‚å–®";
        cancelButton.className = "cancel-order-btn";
        cancelButton.onclick = cancelOrder;
    
        buttonContainer.appendChild(confirmButton);
        buttonContainer.appendChild(cancelButton);
    
        let cartDiv = document.getElementById("cart");
        cartDiv.appendChild(buttonContainer);
    }

    function confirmOrder() {
      let tableValue = "";
      if (orderType === "å…§ç”¨") {
        tableValue = selectedTableNumber;
      } else {
        tableValue = `å¤–å¸¶`;
      }

function showTakeoutOverlay(number) {
    let overlay = document.createElement("div");
    overlay.className = "takeout-overlay";
    overlay.innerHTML = `
         <h1>${number}</h1>
         <p>é€™æ˜¯æ‚¨çš„å¤–å¸¶è¨‚å–®è™Ÿç¢¼<br>
         è«‹è¨˜ä½æˆ–æ‹ç…§ä¿å­˜ï¼Œ<br>
         7ç§’å¾Œè‡ªå‹•é—œé–‰æ­¤ç•«é¢</p>
    `;
    document.body.appendChild(overlay);
    setTimeout(() => {
         overlay.remove();
         location.reload();
    }, 7000);
}


      let itemsArray = Array.from(selectedItems).map(([name, { item, quantity }]) => ({
        name: item.name,
        price: item.price,
        quantity: quantity
      }));

      fetch('/submit-order', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ table: tableValue, items: itemsArray })
})
.then(response => response.json())
.then(data => {
    if (orderType === "å¤–å¸¶" && data.takeoutNumber) {
         showTakeoutOverlay(data.takeoutNumber);
    } else {
         showNotification("è¨‚å–®å·²ç¢ºèªï¼Œè«‹è€å¿ƒç­‰å€™");
         setTimeout(() => {
             location.reload();
         }, 1500);
    }
})
.catch(error => {
  showModal("ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡è©¦ï¼");
  console.error("æäº¤è¨‚å–®éŒ¯èª¤", error);
});

    }

    function cancelOrder() {
      location.reload();
    }

    function showModal(message) {
      let modal = document.getElementById("customModal");
      let msg = document.getElementById("modalMessage");
      msg.textContent = message;
      modal.style.display = "flex";
    }

    function closeModal() {
      let modal = document.getElementById("customModal");
      modal.style.display = "none";
    }

    function showNotification(message) {
      let existingNotification = document.querySelector(".notification");
      if (existingNotification) existingNotification.remove();

      let notification = document.createElement("div");
      notification.className = "notification";
      notification.innerText = message;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.remove();
      }, 3000);
    }
  </script>
</body>
</html>